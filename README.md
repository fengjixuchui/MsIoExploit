<p align="center">
<img src="image.gif">

<img src="https://img.shields.io/github/workflow/status/kkent030315/MsIoExploit/MSBuild?style=for-the-badge">
<img src="https://img.shields.io/badge/platform-win--64-00a2ed?style=for-the-badge">
<img src="https://img.shields.io/codacy/grade/80af226b06214213bc3d2a44c9624222?style=for-the-badge">
<img src="https://img.shields.io/github/license/kkent030315/MsIoExploit?style=for-the-badge">
</p>

# MsIoExploit

Exploit MsIo vulnerable driver

# Description

This is a PoC for [CVE-2019-18845](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18845) `MsIo64.sys` allowing non-privileged user to map/unmap arbitrary physical memory via `ZwMapViewOfSection` / `ZwUnmapViweOfSection`.
If you are interested in abusing physical memory mapping, see [project anycall](https://github.com/kkent030315/anycall/tree/main/anycall) has full implementation of client and driver-sided functionalities.

Allowing non-privileged(non-kernel) component to map arbitrary physical memory is the most *bad* practice and critically vulnerable way which allowing attacker to gain full control of the system as I demonstrated arbitrary NT-Kernel API invocation in this PoC.
You can try by yourself by executing this while you have driver running.

Also this driver and `MsIo64.dll` are fully copy & paste of [IO-Memory](https://github.com/Bleichroder/IO-Memory)
This exploit was first reported 2019 but still remains unfixed and hardware vendors like ASRock still use this driver.

# Usage

```bash
> MsIoExploit.exe
```

# Credit

Several sources regarding token steal are from [ExploitCapcom](https://github.com/tandasat/ExploitCapcom)

Credit [@tandasat](https://github.com/tandasat/)

# License

MIT copyright Kento Oki \<hrn832@protonmail.com\>